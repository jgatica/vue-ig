<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Instroduccion a Vuex</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
          integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
</head>
<body>

<div id="app" class="container mt-5">
    <padre></padre>
    <hijo></hijo>
</div>

<!-- development version, includes helpful console warnings -->
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://unpkg.com/vuex@3.5.1/dist/vuex.js"></script>
<script>
    Vue.component('padre',{
        template: `
            <div class="bg-dark text-white p-3">
                <p>Titulo padre</p>
                <p>Numero en padre de vuex status numero: {{$store.state.numero}}</p>
            </div>
        `
    });

    Vue.component('hijo',{
        template: `
            <div class="bg-dark text-white p-3">
                <h1>Listado de nombres</h1>
                <button class="btn btn-danger" @click="obtenerCursos">Listar</button>
                <ul>
                  <li v-for="item of cursos">{{ item.nombre }}</li>
                </ul>
                <p>Numero en hijo de vuex status numero: {{numero}}</p>
            </div>
        `,
        computed: {
            ...Vuex.mapState(['numero','cursos'])
        },
        methods: {
            ...Vuex.mapActions (['obtenerCursos']),
            ...Vuex.mapMutations(['listarCursos'])
        }
    });

    const store = new Vuex.Store({
        state: {
            numero: 15,
            cursos: []
        },
        mutations: {
            listarCursos(state, cursosObtenidos) {
                state.cursos = cursosObtenidos
            }
        },
        actions: {
            obtenerCursos: async function ({commit}) {
                cursos = await fetch('datos.json');
                cursosJson = await cursos.json();
                store.commit('listarCursos', cursosJson)
            }
        }

    });

    new Vue({
        el: '#app',
        store: store
    });
</script>
</body>
</html>